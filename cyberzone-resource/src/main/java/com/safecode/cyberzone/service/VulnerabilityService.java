package com.safecode.cyberzone.service;

import java.sql.Timestamp;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.web.multipart.MultipartFile;

import com.github.pagehelper.PageInfo;
import com.safecode.cyberzone.pojo.VulnerabilityCnvd;
import com.safecode.cyberzone.pojo.VulnerabilityNvd;
import com.safecode.cyberzone.vo.VulnerabilityCnvdVo;
import com.safecode.cyberzone.vo.VulnerabilityNvdVo;

public interface VulnerabilityService {

	void readSqlFile(MultipartFile sqlFile, HttpServletRequest request) throws Exception;

	PageInfo<VulnerabilityCnvd> queryPageList(VulnerabilityCnvdVo vulnerabilityCnvdVo);

	Map<String, Object> queryById(String id);

	void autoSync() throws Exception;

	Timestamp getCNVDLastUpdateTime();

	PageInfo<VulnerabilityNvd> queryNvdPageList(VulnerabilityNvdVo vulnerabilityNvdVo);

	Timestamp getNVDLastUpdateTime();

	List<Map<String, Object>> getBugCountByServerity();

	List<Map<String, Object>> getBugCountByYear();

	List<VulnerabilityCnvd> getKeyNews();

	List<Map<String, Object>> getBugCountByClassify();
}
