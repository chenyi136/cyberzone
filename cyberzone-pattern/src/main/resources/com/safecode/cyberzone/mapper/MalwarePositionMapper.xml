<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.safecode.cyberzone.mapper.MalwarePositionMapper">

    <resultMap type="com.safecode.cyberzone.entity.MalwarePosition" id="malwarePositionMap">
        <id property="id" column="id"/>
        <result property="msgId" column="msg_id"/>
        <result property="blobScale" column="blob_scale"/>
        <result property="variable" column="variable"/>
        <result property="content" column="content"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="createrCode" column="creater_code"/>
        <result property="createrName" column="creater_name"/>
    </resultMap>

    <sql id="malwarePositionSql">
        id
        ,
        msg_id,
        blob_scale,
        variable,
        content,
        create_time,
        update_time,
        creater_name,
        creater_code
    </sql>

    <sql id="malwarePositionWebSql">
        blob_scale
        ,
        variable,
        content
    </sql>
    <insert id="addMalwarePosition" useGeneratedKeys="true" keyProperty="id"
            parameterType="com.safecode.cyberzone.entity.MalwarePosition">
        insert into malware_position(id,
                                     msg_id,
                                     blob_scale,
                                     variable,
                                     content,
                                     create_time,
                                     update_time,
                                     creater_name,
                                     creater_code)
        values (#{id},
                #{msgId},
                #{blobScale},
                #{variable},
                #{content},
                #{createTime},
                #{updateTime},
                #{createrName},
                #{createrCode})
    </insert>
    <select id="findMalwarePositionByMsgId" parameterType="string" resultMap="malwarePositionMap">
        SELECT
        <include refid="malwarePositionWebSql"/>
        FROM
        malware_position
        <where>
            msg_id = #{msgId}
        </where>
        order by blob_scale
    </select>


</mapper>
