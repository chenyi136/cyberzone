<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.safecode.cyberzone.mapper.MalwareMsgMapper">

    <resultMap type="com.safecode.cyberzone.entity.MalwareMsg" id="malwareMsgMap">
        <id property="id" column="id"/>
        <result property="codeId" column="code_id"/>
        <result property="fileName" column="file_name"/>
        <result property="ruleName" column="rule_name"/>
        <result property="ruleStr" column="rule_str"/>
        <result property="author" column="author"/>
        <result property="reference" column="reference"/>
        <result property="ref" column="ref"/>
        <result property="weight" column="weight"/>
        <result property="description" column="description"/>
        <result property="version" column="version"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
        <result property="createrCode" column="creater_code"/>
        <result property="createrName" column="creater_name"/>

    </resultMap>

    <sql id="malwareMsgSql">
        id
        ,
        code_id,
        file_name,
        rule_name,
        rule_str,
        author,
        reference,
        ref,
        weight,
        description,
        version,
        create_time,
        update_time,
        creater_code,
        creater_name
    </sql>

    <sql id="malwareMsgWebsql">
        id
        ,
        file_name,
        rule_name,
        rule_str,
        author,
        reference,
        ref,
        weight,
        description,
        version
    </sql>

    <insert id="addMalwareMsg" useGeneratedKeys="true" keyProperty="id"
            parameterType="com.safecode.cyberzone.entity.MalwareMsg">
        insert into malware_msg(id,
                                code_id,
                                file_name,
                                rule_name,
                                rule_str,
                                author,
                                reference,
                                ref,
                                weight,
                                description,
                                version,
                                create_time,
                                update_time,
                                creater_code,
                                creater_name)
        values (#{id},
                #{codeId},
                #{fileName},
                #{ruleName},
                #{ruleStr},
                #{author},
                #{reference},
                #{ref},
                #{weight},
                #{description},
                #{version},
                #{createTime},
                #{updateTime},
                #{createrCode},
                #{createrName})
    </insert>
    <select id="findMalwareMsgsByCodeId" parameterType="string" resultMap="malwareMsgMap">
        SELECT
        <include refid="malwareMsgWebsql"/>
        FROM
        malware_msg
        <where>
            code_id = #{codeId}
        </where>
        order by rule_name
    </select>

</mapper>
